# Authenticated Encryption with Additional Data

## Example
```C#
var message = System.Text.Encoding.UTF8.GetBytes("Hello, World!");
var key = SecretBox.GenerateKey();
var nonce = SecretAead.GenerateNonce();
var ad = System.Text.Encoding.UTF8.GetBytes("additional data");

// encrypt with additional data
var encrypted = SecretAead.Encrypt(message, nonce, key, ad);

// encrypt without additional data
var encrypted = secretAead.Encrypt(message, nonce, key);

// decrypt with additional data
var decrypted = SecretAead.Decrypt(encrypted, nonce, key, ad);
```

## Purpose

This class allows you to encrypt a message with a given key and nonce, and additional computes an authenticate tag that you can use to verify both the message and the additional data (non confidential, not encrypted) haven't been tampered with.

## Generate nonce

__Namespace:__ _Sodium.SecretAead_

```C#
public static byte[] Sodium.SecertAead.GenerateNonce()
```

This method generates a 8 byte `nonce`

> To prevent nonce reuse, if your key is going to be reused, use `Sodium.Utilities.Increment` on your nonce rather than generating a random nonce for each message.

## Encrypt

__Namespace:__ _Sodium.SecretAead_

```C#
public static byte[] Sodium.SecretAead.Encrypt(byte[] message, byte[] nonce, byte[] key)
public static byte[] Sodium.SecretAead.Encrypt(byte[] message, byte[] nonce, byte[] key, byte[] additionalData)
```

This method encrypts a message with a 8 bytes `nonce` and a 32 byte `key`. The public `nonce` should never be reused with the same key. `Sodium.Utilities.Increment` can be used to increment your nonce when computing new mesages.

> This method is overloaded so that `additionalData` is optional. If you are not using `additionalData` with your message, `libsodium-uwp` will set it to be a single byte `0x00`. For portability purposes use this single byte if your application does not set `additionalData`. Note that the `additionalData` if set must be between 0 and 16 bytes.

_This method uses internally `crypto_aead_chacha20poly1305_encrypt`._

## Decrypt

__Namespace:__ _Sodium.SecretAead_

```C#
public static byte[] Sodium.SecretAead.Decrypt(byte[] encrypted, byte[] nonce, byte[] key)
public static byte[] Sodium.SecretAead.Decrypt(byte[] encrypted, byte[] nonce, byte[] key, byte[] additionalData)
```

This method decrypts an encrypted ciphertext generated by `Sodium.SecretAead.Encrypt` using a 8 byte `nonce` and a 32 byte `key`, and an optional `additionalData`.

> This method is overloaded so that `additionalData` is optional. If you are not using `additionalData` with your message, `libsodium-uwp` will set it to be a single byte `0x00`. For portability purposes use this single byte if your application does not set `additionalData`. Note that the `additionalData` if set must be between 0 and 16 bytes.

# Algorithm Details

- Encryption: ChaCha20 stream cipher
- Authentication: Poly1305 MAC

> `libsodium` provides 3 AEAD methods. This library _only_ implements SecretAead using `chacha20_pol1305`.