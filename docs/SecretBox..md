# Secret-key authenticated encryption

## Example
```C#
var nonce = Sodium.SecretBox.GenerateNonce(); // 24 byte nonce
var key = Sodium.SecretBox.GenerateKey(); // 32 byte key
var message = System.Text.Encoding.UTF8.GetBytes("Hello, World!");

// encrypt the message
var encrypted = SecretBox.Create(message, nonce, key);
// decrypt it again
var decrypted = SecretBox.Open(encrypted, nonce, key);
```

## Purpose

Secret Key boxes are used to encrypt a message with a key and nonce to keep it confidential. Additionally this operation will compute an authentication take that is used to ensure the message hasn't been tampered with before decryption.

Secret key boxes use a single key to encrypt/sign and decrypt/verify messages. The 32 byte key that you use should be kept confidential.

The nonce used does not have to be confidential, but should never be reused with the same key.

## Generate nonce

__Namespace:__ _Sodium.SecretBox_

```C#
public static byte[] Sodium.SecretBox.GenerateNonce()
```

This method generates a 24 byte nonce.

## Generate key

__Namespace:__ _Sodium.SecretBox_

```C#
public static byte[] Sodium.SecretBox.GenerateKey()
```

This method generates a 32 byte key.

> 32 byte keys can also be generated through a KDF function such as PBKDF2, or HKDF.

## Encrypt a message

__Namespace:__ _Sodium.SecretBox_

```C#
public static byte[] Sodium.SecretBox.Create(byte[] message, byte[] nonce, byte[] key)
public static byte[] Sodium.SecretBox.Create(string message, byte[] nonce, byte[] key)
```

This method encrypts a given `message` with a 24 byte `nonce` and a 32 byte `key`. The resulting byte array will contain the encrypted message and a 16 byte authentication tag prepended to the encrypted message.

_This method internally uses `crypto_secretbox_easy`._

## Decrypt a message

__Namespace:__ _Sodium.SecretBox_

```C#
public static byte[] Sodium.SecretBox.Open(byte[] ciphertext, byte[] nonce, byte[] key)
```

This method decrypts a ciphertext generated by `Sodium.SecretBox.Create` using the generated `ciphertext` and the 24 byte `nonce` and 32 byte `key` originally used to encrypt them message.

This method will return a byte array on success.

_This method internally uses `crypto_secretbox_open_easy`._
# Algorithm Details

- Encryption: XSalsa20 stream cipher
- Authentication: Poly1305 MAC