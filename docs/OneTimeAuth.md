# One Time Authentication

One-time authentication in Sodium uses Poly1305, a Wegman-Carter authenticator designed by D. J. Bernstein.

OTA takes a string message, and a 32 byte key and produces a 16 byte authentication tag that authentications the message in such a way that an adversary has a negligible chance of producing a valid tag for an inauthentiic message.

> Keys should _never_ be reused, even with different message.

## Example

```C#
string message = "Hello, World!";
var key = OneTimeAuth.GenerateKey();

// Get the authentication code
var signature = OneTimeAuth.Sign(message, key);

if (OneTimeAuth.Verify(message, signature, key)) {
    // message iis ok
}
```

## Sign

__Namespace:__ _Sodium.OneTimeAuth_

```C#
public static byte[] Sodium.OneTimeAuth.Sign(byte[] message, byte[] key);
public static byte[] Sodium.OneTimeAuth.Sign(string message, byte[] key);
```

`Sign` takes a `message` and a 32 byte `key`, and produces a 16 byte authentication tag.

_Internally this method uses `crypto_onetimeauth`._

## Verify

```C#
public static bool Sodium.OneTimeAuth(byte[] message, byte[] signature, byte[] key);
public static bool Sodium.OneTimeAuth(String message, byte[] signature, byte[] key);
```

Authentication tags generated by `OneTimeAuth.Sign()` can be verified using this method, which accepts the original `message`, the 16 byte `signature`, and the 32 byte `key` used to authenticate the message. This method will return `true` if the `signature` is valid for `message`, and `false` otherwise.

_Internally this method uses `crypto_onetimeauth_verify`._
# Algorithm Details
- Poly 1305